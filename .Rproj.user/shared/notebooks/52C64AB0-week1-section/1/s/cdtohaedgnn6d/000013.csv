"0","##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"0","##                                    setup                                 ----"
"0","##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"0",""
"0","#..........................load packages........................."
"0","library(tidyverse)"
"0","library(janitor)"
"0","library(usdata)"
"0",""
"0","#......................import fracking data......................"
"0","fracking <- read_csv(here::here(""week-1"", ""data"", ""fracking.csv""))"
"2","[1mRows: [22m[34m100000[39m [1mColumns: [22m[34m21[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m (11): pKey, JobStartDate, JobEndDate, APINumber, StateNumber, CountyNumber, OperatorName, WellName, Projection, StateName, ...
[32mdbl[39m  (6): Latitude, Longitude, TVD, TotalBaseWaterVolume, TotalBaseNonWaterVolume, FFVersion
[33mlgl[39m  (4): FederalWell, IndianWell, Source, DTMOD"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"0","##                        clean/wrangle fracking data                       ----"
"0","##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"0",""
"0","fracking_clean <- fracking |> "
"0","  "
"0","  # clean column names ----"
"0","  janitor::clean_names() |> "
"0","  "
"0","  # clean up dates ----"
"0","  mutate(job_start_date = str_remove(job_start_date, "" AM"")) |> # remove 'AM' from string"
"0","  mutate(datetime_start = mdy_hms(job_start_date)) |> # convert from string to date (save to new col)"
"0","  mutate(year = year(datetime_start)) |> # create 'year' col from date"
"0",""
"0","  # select relevant cols ----"
"0","  select(datetime_start, year, state_name, county_name, well_name, total_base_water_volume) |> "
"0","  "
"0","  # filter out non-state names ----"
"0","  filter(!state_name %in% c(""Beaver"", ""Beckham"", ""Harper"", ""Hemphill"", ""Midland"", ""Red River"", ""Roosevelt"", ""Rusk"", ""State"", ""WARD"")) |> "
"0","  "
"0","  # rename state_name to something shorter for typing out when using case_when (not necessary) ----"
"0","  rename(sn = state_name) |> "
"0","  "
"0","  # make all words title case ----"
"0","  mutate(sn = str_to_title(sn)) |> "
"0","  "
"0","  # fix misspelled state names ----"
"0","  mutate(sn = case_when("
"0","    sn == ""Colordao"" ~ ""Colorado"","
"0","    sn == ""Loiusiana"" ~ ""Louisiana"","
"0","    sn == ""Louisianna"" ~ ""Louisiana"","
"0","    sn == ""Lousiana"" ~ ""Louisiana"","
"0","    sn == ""New Mexcio"" ~ ""New Mexico"","
"0","    sn == ""Norh Dakota"" ~ ""North Dakota"","
"0","    sn == ""Norht Dakota"" ~ ""North Dakota"","
"0","    sn == ""North  Dakota"" ~ ""North Dakota"","
"0","    sn == ""North Dakata"" ~ ""North Dakota"","
"0","    sn == ""North Dakotta"" ~ ""North Dakota"","
"0","    sn == ""Noth Dakota"" ~ ""North Dakota"","
"0","    sn == ""Pennslvania"" ~ ""Pennsylvania"","
"0","    sn == ""Pennsylavania"" ~ ""Pennsylvania"","
"0","    sn == ""Pennsylvanya"" ~ ""Pennsylvania"","
"0","    sn == ""Penssylvania"" ~ ""Pennsylvania"","
"0","    sn == ""Texasa"" ~ ""Texas"","
"0","    sn == ""Texs"" ~ ""Texas"", "
"0","    sn == ""West Viginia"" ~ ""West Virginia"","
"0","    sn == ""Wyominng"" ~ ""Wyoming"", "
"0","    TRUE ~ sn # copy over rest of state names from as-is"
"0","  )) |> "
"0","  "
"0","  # remove rows that have a '?' mark ----"
"0","  filter(!str_detect(string = sn, pattern = ""\\?"")) |> # `?` is a special chr; escape with `\\` prefix"
"0","  "
"0","  # make all uppercase (so that we can covert abbreviation to state names) ----"
"0","  mutate(sn = str_to_upper(sn)) |> "
"0","  "
"0","  # mutate abbreviations to full state names ----"
"0","  mutate(sn = ifelse(test = str_length(sn) == 2, # if string in 'sn' col is 2 chrs long"
"0","                     yes = usdata::abbr2state(sn), # replace abbreviation with full state name "
"0","                     no = sn)) |> # if string in 'sn' col is not 2 chrs long, keep state name as-is"
"0","  "
"0","  # make all words title case again ----"
"0","  mutate(sn = str_to_title(sn)) |> "
"0","  "
"0","  # create a column of just state abbreviations ----"
"0","  mutate(state_abb = usdata::state2abbr(sn)) |> "
"0","  "
"0","  # rename 'sn' to 'state_name' again for clarity ----"
"0","  rename(state_name = sn, total_base_water_volume_gal = total_base_water_volume) |> "
"0","  "
"0","  # move 'state_abb' col after state_name col ----"
"0","  relocate(state_abb, .after = state_name) |> "
"0","  "
"0","  # convert 'state_name' & 'state_abb' from string to factor ----"
"0","  mutate(state_name = as.factor(state_name),"
"0","         state_abb = as.factor(state_abb)) |> "
"0","  "
"0","  # remove obs that don't have a measurement for 'total_base_water_volume' (NA) ----"
"0","  drop_na(total_base_water_volume_gal)"
"0",""
"0","##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"0","##          some exploratory data viz + a few plot mods for practice        ----"
"0","##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"0",""
"0","fracking_clean |> "
"0","  filter(state_name %in% c(""Texas"", ""Colorado"", ""North Dakota"")) |> "
"0","  filter(year == 2015) |> "
"0","  group_by(state_name) |> # pipe directly into ggplot"
"0","  ggplot(aes(x = fct_rev(fct_infreq(state_name)), y = total_base_water_volume_gal)) + # need to reverse fct order for coord_flip() (plots lowest freq at top by default)"
"0","  geom_jitter(width = 0.3, alpha = 0.5, color = ""gray15"") +"
"0","  geom_violin(color = ""red4"", alpha = 0.3) +"
"0","  scale_y_continuous(labels = scales::label_comma()) +"
"0","  labs(y = ""Total base water volumn (gal)"") +"
"0","  coord_flip() +"
"0","  theme_minimal() +"
"0","  theme("
"0","    axis.title.y = element_blank()"
"0","    ) "
